<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-how">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">How to use Codex | Codex</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://codex.storage/how"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="codex, storage"><meta data-rh="true" name="image" content="theme/image/preview-image.png"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="How to use Codex | Codex"><meta data-rh="true" name="description" content="Codex is building a Decentralized Durability Storage Engine"><meta data-rh="true" property="og:description" content="Codex is building a Decentralized Durability Storage Engine"><link data-rh="true" rel="icon" href="/theme/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://codex.storage/how"><link data-rh="true" rel="alternate" href="https://codex.storage/how" hreflang="en"><link data-rh="true" rel="alternate" href="https://codex.storage/how" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.53b8852f.css">
<link rel="preload" href="/assets/js/runtime~main.cb4eb163.js" as="script">
<link rel="preload" href="/assets/js/main.578a4729.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div class="background-underlay"></div><div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="row root_EyAR"><div class="col col--2"><button class="sidebarButton_J1Af expand_tygE mobile_UU2r"><svg width="40" height="34" viewBox="0 0 40 34" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 12a1 1 0 1 0 0 2h20a1 1 0 1 0 0-2H10Zm0 8a1 1 0 1 0 0 2h20a1 1 0 1 0 0-2H10Z" fill="#000"></path></svg></button><button class="sidebarButton_J1Af desktop_wg2C"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M11.765 5.294 7.059 10l4.706 4.706" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div><div class="col headerMiddle_pL9e"><div class="menu_QD7H leftContainer_NrEj"><div class="navbarLogoWrapper_W_AQ"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/theme/image/logo.svg" alt="Codex" class="themedImage_ToTc themedImage--light_HNdA" height="26" width="24"><img src="/theme/image/logo.svg" alt="Codex" class="themedImage_ToTc themedImage--dark_i4oU" height="26" width="24"></div><b class="navbar__title text--truncate"></b></a></div><div class="searchContainer_pZUQ"><div class="searchBox_ZlJk"></div></div></div><div><nav class="menu_QD7H links_tkpD"><a class="navbar__item navbar__link" href="/blog">Blog</a></nav></div></div><div class="col col--4 headerRight_ozxj"><button type="button" class="clean-btn root_wSGo shareButton_AVRM" title="share this page" aria-label="share this page"><svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M12.5 10.5c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3c0-.24.03-.46.09-.69l-4.38-2.3c-.55.61-1.33.99-2.21.99-1.66 0-3-1.34-3-3s1.34-3 3-3c.88 0 1.66.39 2.21.99l4.38-2.3c-.06-.23-.09-.45-.09-.69 0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3c-.88 0-1.66-.39-2.21-.99l-4.38 2.3c.121.452.121.928 0 1.38l4.38 2.3c.55-.61 1.33-.99 2.21-.99Z" fill="#000"></path></svg></button><div class="divider_qZaM"></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">EN</a><svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="m2 4 4 4 4-4" stroke="#909091" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"></path></svg><ul class="dropdown__menu"><li><a href="/how" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div></div><div class="col headerRightMobile_kTRW"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">EN</a><svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="m2 4 4 4 4-4" stroke="#909091" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"></path></svg><ul class="dropdown__menu"><li><a href="/how" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><button type="button" class="clean-btn root_wSGo searchButton_CBpt"><div class="icon_S7Kx m_thRi"><svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><g clip-path="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.79 6.75a4.979 4.979 0 1 1 9.957 0 4.979 4.979 0 0 1-9.957 0ZM6.768.572a6.179 6.179 0 1 0 3.817 11.037l5.146 5.146a1 1 0 0 0 1.414-1.414l-5.207-5.207A6.179 6.179 0 0 0 6.768.571Z" fill="#000"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h18v18H0z"></path></clipPath></defs></svg></div></button></div><div class="mobileSearchContainer_nT8L"><div class="root_Aj0B"><div><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/theme/image/logo.svg" alt="Codex" class="themedImage_ToTc themedImage--light_HNdA" height="26" width="24"><img src="/theme/image/logo.svg" alt="Codex" class="themedImage_ToTc themedImage--dark_i4oU" height="26" width="24"></div><b class="navbar__title text--truncate"></b></a></div><div></div><div><button class="clean-btn">Cancel</button></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_Djow"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage_Lnim"><aside class="theme-doc-sidebar-container docSidebarContainer_hEcO"><div class="sidebar_UEyd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Home</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/how">How to use Codex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/student-program">Codex Students Program</a></li></ul></nav></div></aside><main class="docMainContainer_M0BZ"><div class="sidebarSpace_GZd1"></div><div class="padding-top--md padding-bottom--lg docItemWrapper_q141"><div class="root_m3xo row"><div class="col docItemCol_F52z"><div class="docItemContainer_hrrU"><div><article><div class="tocCollapsible_ROek theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_CltZ"><div class="icon_S7Kx m_thRi"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M11.764 5.294 7.06 10l4.705 4.706" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>Contents</button></div><div class="theme-doc-markdown markdown"><h1>How to use Codex</h1><blockquote><p>The Codex project aims to create a decentralized durability engine that allows persisting data in p2p networks. In other words, it allows storing files and data with predictable durability guarantees for later retrieval.</p></blockquote><blockquote><p>WARNING: This project is under active development and is considered pre-alpha.</p></blockquote><p><a href="https://opensource.org/licenses/Apache-2.0" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://img.shields.io/badge/License-Apache%202.0-blue.svg" alt="License: Apache" class="img_ev3q"></a>
<a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://img.shields.io/badge/License-MIT-blue.svg" alt="License: MIT" class="img_ev3q"></a>
<a href="#stability"><img loading="lazy" src="https://img.shields.io/badge/stability-experimental-orange.svg" alt="Stability: experimental" class="img_ev3q"></a>
<a href="https://github.com/status-im/nim-codex/actions?query=workflow%3ACI+branch%3Amain" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://github.com/status-im/nim-codex/actions/workflows/ci.yml/badge.svg?branch=main" alt="CI" class="img_ev3q"></a>
<a href="https://codecov.io/gh/status-im/nim-codex" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://codecov.io/gh/status-im/nim-codex/branch/main/graph/badge.svg?token=XFmCyPSNzW" alt="Codecov" class="img_ev3q"></a>
<a href="https://discord.gg/CaJTh24ddQ" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://img.shields.io/discord/895609329053474826" alt="Discord" class="img_ev3q"></a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="build-and-run">Build and Run<a class="hash-link" href="#build-and-run" title="Direct link to heading">​</a></h2><p>For detailed instructions on preparing to build nim-codex see <a href="/BUILDING.md"><em>Building Codex</em></a>.</p><p>To build the project, clone it and run:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">make</span><span class="token plain"> update </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> </span><span class="token builtin class-name">exec</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The executable will be placed under the <code>build</code> directory under the project root.</p><p>Run the client with:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">build/codex</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cli-options">CLI Options<a class="hash-link" href="#cli-options" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">build/codex --help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Usage:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">codex [OPTIONS]... command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The following options are available:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --log-level            Sets the log level [=LogLevel.INFO].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --metrics              Enable the metrics server [=false].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --metrics-address      Listening address of the metrics server [=127.0.0.1].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --metrics-port         Listening HTTP port of the metrics server [=8008].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -d, --data-dir             The directory where codex will store configuration and data..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -l, --listen-port          Specifies one or more listening ports for the node to listen on. [=0].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -i, --listen-ip            The public IP [=0.0.0.0].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --udp-port             Specify the discovery (UDP) port [=8090].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --net-privkey          Source of network (secp256k1) private key file (random|&lt;path&gt;) [=random].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -b, --bootstrap-node       Specifies one or more bootstrap nodes to use when connecting to the network..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --max-peers            The maximum number of peers to connect to [=160].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --agent-string         Node agent string which is used as identifier in network [=Codex].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -p, --api-port             The REST Api port [=8080].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -c, --cache-size           The size in MiB of the block cache, 0 disables the cache [=100].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --persistence          Enables persistence mechanism, requires an Ethereum node [=false].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --eth-provider         The URL of the JSON-RPC API of the Ethereum node [=ws://localhost:8545].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --eth-account          The Ethereum account that is used for storage contracts [=EthAddress.none].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     --eth-deployment       The json file describing the contract deployment [=string.none].</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Available sub-commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">codex initNode</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-running-two-codex-clients">Example: running two Codex clients<a class="hash-link" href="#example-running-two-codex-clients" title="Direct link to heading">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">build/codex --data-dir</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable builtin class-name" style="color:#36acaa">pwd</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">/Codex1&quot;</span><span class="token plain"> -i</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will start codex with a data directory pointing to <code>Codex1</code> under the current execution directory and announce itself on the DHT under <code>127.0.0.1</code>.</p><p>To run a second client that automatically discovers nodes on the network, we need to get the Signed Peer Record (SPR) of first client, Client1. We can do this by querying the <code>/info</code> endpoint of the node&#x27;s REST API.</p><p><code>curl http://127.0.0.1:8080/api/codex/v1/info</code></p><p>This should output information about Client1, including its PeerID, TCP/UDP addresses, data directory, and SPR:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;16Uiu2HAm92LGXYTuhtLaZzkFnsCx6FFJsNmswK6o9oPXFbSKHQEa&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;addrs&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;/ip4/0.0.0.0/udp/8090&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;/ip4/0.0.0.0/tcp/49336&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;repo&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/repos/status-im/nim-codex/Codex1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;spr&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;spr:CiUIAhIhAmqg5fVU2yxPStLdUOWgwrkWZMHW2MHf6i6l8IjA4tssEgIDARpICicAJQgCEiECaqDl9VTbLE9K0t1Q5aDCuRZkwdbYwd_qLqXwiMDi2ywQ5v2VlAYaCwoJBH8AAAGRAh-aGgoKCAR_AAABBts3KkcwRQIhAPOKl38CviplVbMVnA_9q3N1K_nk5oGuNp7DWeOqiJzzAiATQ2acPyQvPxLU9YS-TiVo4RUXndRcwMFMX2Yjhw8k3A&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, let&#x27;s start a second client, Client2. Because we&#x27;re already using the default ports TCP (:8080) and UDP (:8090) for the first client, we have to specify new ports to avoid a collision. Additionally, we can specify the SPR from Client1 as the bootstrap node for discovery purposes, allowing Client2 to determine where content is located in the network.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">build/codex --data-dir</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable builtin class-name" style="color:#36acaa">pwd</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">/Codex2&quot;</span><span class="token plain"> -i</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1 --api-port</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">8081</span><span class="token plain"> --udp-port</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">8091</span><span class="token plain"> --bootstrap-node</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">spr:CiUIAhIhAmqg5fVU2yxPStLdUOWgwrkWZMHW2MHf6i6l8IjA4tssEgIDARpICicAJQgCEiECaqDl9VTbLE9K0t1Q5aDCuRZkwdbYwd_qLqXwiMDi2ywQ5v2VlAYaCwoJBH8AAAGRAh-aGgoKCAR_AAABBts3KkcwRQIhAPOKl38CviplVbMVnA_9q3N1K_nk5oGuNp7DWeOqiJzzAiATQ2acPyQvPxLU9YS-TiVo4RUXndRcwMFMX2Yjhw8k3A</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There are now two clients running. We could upload a file to Client1 and download that file (given its CID) using Client2, by using the clients&#x27; REST API.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="interacting-with-the-client">Interacting with the client<a class="hash-link" href="#interacting-with-the-client" title="Direct link to heading">​</a></h2><p>The client exposes a REST API that can be used to interact with the clients. These commands could be invoked with any HTTP client, however the following endpoints assume the use of the <code>curl</code> command.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="apicodexv1connectpeerid"><code>/api/codex/v1/connect/{peerId}</code><a class="hash-link" href="#apicodexv1connectpeerid" title="Direct link to heading">​</a></h3><p>Connect to a peer identified by its peer id. Takes an optional <code>addrs</code> parameter with a list of valid <a href="https://multiformats.io/multiaddr/" target="_blank" rel="noopener noreferrer">multiaddresses</a>. If <code>addrs</code> is absent, the peer will be discovered over the DHT.</p><p>Example:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1:8080/api/codex/v1/connect/&lt;peer id&gt;?addrs=&lt;multiaddress&gt;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="apicodexv1downloadid"><code>/api/codex/v1/download/{id}</code><a class="hash-link" href="#apicodexv1downloadid" title="Direct link to heading">​</a></h3><p>Download data identified by a <code>Cid</code>.</p><p>Example:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -vvv </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1:8080/api/codex/v1/download/&lt;Cid of the content&gt;&quot;</span><span class="token plain"> --output </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">name of output file</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="apicodexv1upload"><code>/api/codex/v1/upload</code><a class="hash-link" href="#apicodexv1upload" title="Direct link to heading">​</a></h3><p>Upload a file, upon success returns the <code>Cid</code> of the uploaded file.</p><p>Example:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -vvv -H </span><span class="token string" style="color:#e3116c">&quot;content-type: application/octet-stream&quot;</span><span class="token plain"> -H Expect: -T </span><span class="token string" style="color:#e3116c">&quot;&lt;path to file&gt;&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1:8080/api/codex/v1/upload&quot;</span><span class="token plain"> -X POST</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="apicodexv1info"><code>/api/codex/v1/info</code><a class="hash-link" href="#apicodexv1info" title="Direct link to heading">​</a></h3><p>Get useful node info such as its peer id, address and SPR.</p><p>Example:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -vvv </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1:8080/api/codex/v1/info&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Home</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Blog</div></a></nav></div></div></div><aside class="col"></aside><div class="tocDesktopWrapper_v6KB col"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#build-and-run" class="table-of-contents__link toc-highlight">Build and Run</a><ul><li><a href="#cli-options" class="table-of-contents__link toc-highlight">CLI Options</a></li><li><a href="#example-running-two-codex-clients" class="table-of-contents__link toc-highlight">Example: running two Codex clients</a></li></ul></li><li><a href="#interacting-with-the-client" class="table-of-contents__link toc-highlight">Interacting with the client</a><ul><li><a href="#apicodexv1connectpeerid" class="table-of-contents__link toc-highlight"><code>/api/codex/v1/connect/{peerId}</code></a></li><li><a href="#apicodexv1downloadid" class="table-of-contents__link toc-highlight"><code>/api/codex/v1/download/{id}</code></a></li><li><a href="#apicodexv1upload" class="table-of-contents__link toc-highlight"><code>/api/codex/v1/upload</code></a></li><li><a href="#apicodexv1info" class="table-of-contents__link toc-highlight"><code>/api/codex/v1/info</code></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer_gFAr"><div class="row col col--8 footerContentWrapper_q5m6"><div class="sidebarSpace_uwf1"></div><div class="footerContent_JJrU"><div class="lockup_MNVB"><div class="footerLogoWrapper_I1pc"><a class="footerLogoLink_BH7S" href="/"><img src="/theme/image/logo.svg" alt="Codex" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="22"><img src="/theme/image/logo.svg" alt="Codex" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="22"></a></div><span class="sub5"><div class="footer__copyright">Codex, 2023</div></span></div><div><div class="communityLinks_qAhZ"><a href="https://discordapp.com/users/4qdQN5JaWW" target="_blank"><div class="icon_S7Kx m_thRi"><svg width="71" height="55" viewBox="0 0 71 55" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><g clip-path="url(#a)"><path d="M60.105 4.898A58.55 58.55 0 0 0 45.653.415a.22.22 0 0 0-.233.11 40.784 40.784 0 0 0-1.8 3.697c-5.456-.817-10.886-.817-16.23 0-.485-1.164-1.201-2.587-1.828-3.697a.228.228 0 0 0-.233-.11 58.386 58.386 0 0 0-14.451 4.483.207.207 0 0 0-.095.082C1.578 18.73-.944 32.144.293 45.39a.244.244 0 0 0 .093.167c6.073 4.46 11.955 7.167 17.729 8.962a.23.23 0 0 0 .249-.082 42.08 42.08 0 0 0 3.627-5.9.225.225 0 0 0-.123-.312 38.772 38.772 0 0 1-5.539-2.64.228.228 0 0 1-.022-.378c.372-.279.744-.569 1.1-.862a.22.22 0 0 1 .23-.03c11.619 5.304 24.198 5.304 35.68 0a.219.219 0 0 1 .233.027c.356.293.728.586 1.103.865a.228.228 0 0 1-.02.378 36.384 36.384 0 0 1-5.54 2.637.227.227 0 0 0-.121.315 47.249 47.249 0 0 0 3.624 5.897.225.225 0 0 0 .249.084c5.801-1.794 11.684-4.502 17.757-8.961a.228.228 0 0 0 .092-.164c1.48-15.315-2.48-28.618-10.497-40.412a.18.18 0 0 0-.093-.084Zm-36.38 32.427c-3.497 0-6.38-3.211-6.38-7.156 0-3.944 2.827-7.156 6.38-7.156 3.583 0 6.438 3.24 6.382 7.156 0 3.945-2.827 7.156-6.381 7.156Zm23.593 0c-3.498 0-6.38-3.211-6.38-7.156 0-3.944 2.826-7.156 6.38-7.156 3.582 0 6.437 3.24 6.38 7.156 0 3.945-2.798 7.156-6.38 7.156Z" fill="#23272A"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h71v55H0z"></path></clipPath></defs></svg></div></a><a href="https://twitter.com/codexstorage" target="_blank"><div class="icon_S7Kx m_thRi"><svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M16.557 1.597a6.802 6.802 0 0 1-1.95.534A3.406 3.406 0 0 0 16.1.251a6.782 6.782 0 0 1-2.157.824 3.398 3.398 0 0 0-5.788 3.1A9.647 9.647 0 0 1 1.153.624a3.395 3.395 0 0 0-.059 3.31c.264.494.645.915 1.11 1.225a3.389 3.389 0 0 1-1.538-.425v.044a3.398 3.398 0 0 0 2.725 3.33c-.5.136-1.025.156-1.534.06a3.399 3.399 0 0 0 3.173 2.357A6.817 6.817 0 0 1 0 11.934a9.607 9.607 0 0 0 5.207 1.526c6.249 0 9.665-5.176 9.665-9.665 0-.146-.004-.293-.01-.439A6.905 6.905 0 0 0 16.556 1.6l.001-.002Z" fill="#000"></path></svg></div></a></div></div></div></div></footer></div>
<script src="/assets/js/runtime~main.cb4eb163.js"></script>
<script src="/assets/js/main.578a4729.js"></script>
</body>
</html>